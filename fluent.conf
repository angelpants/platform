<system>
  log_level debug
</system>

<source>
  @type tail
  path "./log/log.log"
  pos_file "./log/logfile.pos"
  tag "opentdf"
  format none
</source>

<match opentdf>
  @type splunk_hec
  hec_host "biscoe.local"  # Or the actual host IP if necessary
  hec_port 8088
  hec_token "3af4d721-ad3a-4b15-be48-be9dab7cf29e"  # Replace with your actual HEC token+
  protocol http
<buffer>
    @type memory           # Use memory buffer for speed (can also use file for persistence)
    flush_interval 5s      # Set flush interval to 5 seconds (send logs every 5 seconds)
    flush_at_shutdown true # Ensure logs are flushed on Fluentd shutdown
    chunk_limit_size 1MB   # Set the maximum size of each buffer chunk
    queued_chunks_limit_size 32  # Limit number of queued chunks before flushing
  </buffer>
</match>